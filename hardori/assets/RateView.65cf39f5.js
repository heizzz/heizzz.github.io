import{_ as y,u as _,r as x,o as i,c as l,a as d,b as g,d as n,h as f,v as k,F as m,e as h,i as S,t as b,n as v}from"./index.72084a3a.js";import{B as p}from"./backend.aee7b34f.js";import{_ as R}from"./plugin-vue_export-helper.21dcd24c.js";const w={components:{MessageBox:y},data(){return{songList:[],language:1,selectedSong:this.$route.params.song||128,selectedDiff:this.$route.params.diff||3,myRating:25,loading:!0,diffNames:["EASY","NORMAL","HARD","EXPERT","SPECIAL"],errors:null,processing:!1,success:!1}},created(){this.fetchData()},watch:{selectedSong(t,s){const r=Object.keys(this.songList[t].difficulties).length;this.selectedDiff>=r&&(this.selectedDiff=r-1)},selectedDiff(t,s){this.myRating=this.songList[this.selectedSong].difficulties[t]}},methods:{fetchData(){const t=_();if(t.token==null){t.setMessage("You must be logged in to use this feature!"),this.$router.push("/");return}this.loading=!0,p.getSongList().then(s=>{this.songList=s,this.loading=!1,this.myRating=this.songList[this.selectedSong].difficulties[this.selectedDiff]})},rate(){this.success=!1,this.errors=null;const t=this.songList[this.selectedSong].difficulties[this.selectedDiff];if(this.myRating<t-1||this.myRating>=t+1){this.errors="Rating must be close enough to the official rating";return}this.processing=!0,p.postSongRating(parseInt(this.selectedSong),parseInt(this.selectedDiff),this.myRating).then(s=>{this.processing=!1,this.success=s.success,this.errors=s.errors})},randomSong(){const t=Object.keys(this.songList),s=t.length,r=Math.floor(Math.random()*s);this.selectedSong=t[r]}}},D={class:"container px-4 py-6 mx-auto"},L={key:1,class:"max-w-4xl mx-auto bg-slate-800 py-4 px-40 rounded space-y-4"},M=n("div",{class:"text-center text-2xl font-semibold"},"Rate a Song",-1),B={class:"flex justify-center"},C=n("label",{for:"song"},"Song",-1),V={class:"w-full"},E=["value"],N=n("label",{for:"diff"},"Difficulty",-1),j={class:"space-x-2 inline-block w-full"},A=["onClick","title"],O=n("label",{for:"rating"},"My Rating",-1),F={key:0,class:"text-center block w-full max-w-md mx-auto px-4 py-2 rounded-lg bg-slate-800 hover:bg-slate-700 border border-slate-500 focus:ring-sky-500 focus:ring-1"};function I(t,s,r,P,e,a){const u=x("MessageBox");return i(),l("div",D,[e.loading?(i(),d(u,{key:0,message:"Fetching song data...",class:"max-w-2xl mx-auto"},null,8,["message"])):g("",!0),e.loading?g("",!0):(i(),l("div",L,[M,n("div",B,[e.success?(i(),d(u,{key:0,message:"Success!"})):g("",!0),e.errors?(i(),d(u,{key:1,message:e.errors},null,8,["message"])):g("",!0)]),n("div",null,[C,n("div",V,[f(n("select",{name:"song",id:"song","onUpdate:modelValue":s[0]||(s[0]=o=>e.selectedSong=o),class:"bg-slate-800 rounded-md py-2 px-2 shadow-sm focus:outline-none border border-slate-500 focus:bg-slate-700 focus:ring-sky-500 focus:ring-1"},[(i(!0),l(m,null,h(Object.keys(e.songList),o=>(i(),l("option",{value:o},b(e.songList[o].title[e.language]||e.songList[o].title[0]),9,E))),256))],512),[[k,e.selectedSong]]),n("button",{onClick:s[1]||(s[1]=(...o)=>a.randomSong&&a.randomSong(...o)),class:"px-4 py-2 rounded-md ml-4 bg-slate-800 hover:bg-slate-700 border border-slate-500"},"Random Song")])]),n("div",null,[N,n("div",j,[(i(!0),l(m,null,h(e.songList[e.selectedSong].difficulties,(o,c)=>(i(),l("button",{onClick:U=>e.selectedDiff=c,title:e.diffNames[c],class:v([[`diff-${c}`,e.selectedDiff==c?"ring-1 ring-white":"brightness-75"],"inline-block w-10 h-10 rounded-full"])},b(o),11,A))),256))])]),n("div",null,[O,f(n("input",{type:"number",name:"rating",id:"rating",min:"1",max:"31",step:"0.1","onUpdate:modelValue":s[2]||(s[2]=o=>e.myRating=o),class:"w-full bg-slate-800 rounded-md py-1 px-2 shadow-sm focus:outline-none border border-slate-500 focus:bg-slate-700 focus:ring-sky-500 focus:ring-1"},null,512),[[S,e.myRating]])]),e.processing?(i(),l("div",F," Processing... ")):(i(),l("button",{key:1,onClick:s[3]||(s[3]=(...o)=>a.rate&&a.rate(...o)),class:"block w-full max-w-md mx-auto py-2 rounded-lg bg-slate-800 hover:bg-slate-700 border border-slate-500 focus:ring-sky-500 focus:ring-1"},"Submit Rating"))]))])}var H=R(w,[["render",I]]);export{H as default};
