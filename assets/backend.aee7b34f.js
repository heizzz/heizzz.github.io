import{U as n,u as p}from"./index.72084a3a.js";const o=async(t,s,a)=>{try{const e=await t.json();return e.code===200?(s&&s(e.data),{success:!0,data:e.data}):(a&&a(e.errors),{success:!1,errors:e.errors})}catch(e){return{success:!1,errors:e.message}}},r=t=>{n.setToken(t.token),n.setUsername(t.name),n.setTokenExpiry(new Date().getTime()+t.token_age),p().refresh()},g={api(t){return"https://hardori.glitch.me/api"+t},async getTierList(t){t=t||0;const s={Accept:"application/json","Content-Type":"application/json"},a=n.getToken();a&&(s["access-token"]=a);const e=await fetch(this.api(`/songs/list?page=${t}&sortBy=globalRating`),{method:"GET",headers:s});return await o(e)},async getMyTierList(){const t=n.getToken(),s=await fetch(this.api("/songs/mylist"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json","access-token":t}});return await o(s)},async getSongList(){return(await fetch("/song_data.json")).json()},async postSongRating(t,s,a){const e=JSON.stringify({id:t,difficulty:s,rating:a}),i=n.getToken(),c=await fetch(this.api("/songs/rate"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","access-token":i},body:e});return await o(c)},async login(t,s){const a=JSON.stringify({email:t,password:s}),e=await fetch(this.api("/auth/_login"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:a});return await o(e,r)},async register(t,s,a){const e=JSON.stringify({email:t,name:s,password:a}),i=await fetch(this.api("/auth/_register"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:e});return await o(i,r)}};export{g as B};
