import{U as n,u as p}from"./index.47e535b2.js";const i=async(t,s,a)=>{try{const e=await t.json();return e.code===200?(s&&s(e.data),{success:!0,data:e.data}):(a&&a(e.errors),{success:!1,errors:e.errors})}catch(e){return{success:!1,errors:e.message}}},r=t=>{n.setToken(t.token),n.setUsername(t.name),n.setTokenExpiry(new Date().getTime()+t.token_age),p().refresh()},g={api(t){return"https://hardori.glitch.me/api"+t},async getTierList(t){const s={Accept:"application/json","Content-Type":"application/json"},a=n.getToken();a&&(s["access-token"]=a);let e="/songs/list?sortBy=globalRating";t&&(e+=`&id=${t}`);const o=await fetch(this.api(e),{method:"GET",headers:s});return await i(o)},async getMyTierList(){const t=n.getToken(),s=await fetch(this.api("/songs/mylist"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json","access-token":t}});return await i(s)},async getSongList(){return(await fetch("/song_data.json")).json()},async postSongRating(t,s,a){const e=JSON.stringify({id:t,difficulty:s,rating:a}),o=n.getToken(),c=await fetch(this.api("/songs/rate"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","access-token":o},body:e});return await i(c)},async login(t,s){const a=JSON.stringify({email:t,password:s}),e=await fetch(this.api("/auth/_login"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:a});return await i(e,r)},async register(t,s,a){const e=JSON.stringify({email:t,name:s,password:a}),o=await fetch(this.api("/auth/_register"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:e});return await i(o,r)}};export{g as B};
